# Register Window

Register Window，即寄存器窗口。在计算机工程当中，寄存器窗口是某些ISA当中的特性，用于提高在经常使用的过程调用中的性能。寄存器窗口是伯克利RISC设计中的主要特性之一，并且后来在AMD Am29000，Intel i960，SPARC以及Intel Itanium中商业化使用。

## 概述

大多数CPU设计都包含小规模数量的高速存储，即寄存器。CPU用寄存器保存计算过程中临时的值。可以考虑增加寄存器来增强一个CPU的性能，但是由于寄存器是ISA可见的，因此寄存器的数量在ISA释出后不能轻易的改动。

同样，盲目增加寄存器的数量也会带来负面的影响。一段程序当中不同的部分往往都有它们自身的变量（不同的函数有自身的临时变量）。一般来说，对程序员（一般来说是编译器），它们难以估算整个程序究竟需要多少寄存器，因此往往寄存器会使用所有可见的寄存器。

## 实现

寄存器窗口就是为了解决上述的问题。既然程序中的每一个部分都想将（可见的）寄存器留作自己使用，那么可以选择留作一部分的寄存器是**不可见**的。

使寄存器不可见可以有效的实现：CPU在过程调用中分辨从一个过程中到另一个过程中的数据流动。可以通过上下文切换过程前和后的特定程序段来进行分辨（保存栈、恢复栈等）。在伯克利的设计当中，这些调用结束后会导致一系列的寄存器被“换入”，或者被标记为“死亡”（或者“可重用的”）。

## 在CPU当中的应用

在伯克利的RISC设计当中，在64个寄存器当中只有8个是可见的。完整的寄存器集合成为寄存器堆，64个寄存器中每8个寄存器称作一个窗口（也就是说，只有一个窗口的寄存器组可见）。寄存器堆允许多达8个过程调用可以拥有它们自己的窗口。同时，该设计也只允许过程调用的深度上限为8，因此可以避免寄存器溢出的问题，因为将寄存器值保存到主存或者高速缓存中对于寄存器来说是很慢的。
