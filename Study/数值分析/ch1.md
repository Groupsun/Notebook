# 误差

## 1.1 误差的来源

误差的分类：
- 模型误差：近似的数学模型所带来的误差。
- 观测误差：数据受观测仪器精度的限制。
- 方法误差：用近似方法得到的解与数学模型的准确解之间存在的误差。
- 舍入误差：无限小数保留有限数位。

## 1.2 误差、误差限和有效数字

### 误差

**定义1.1** 设准确值x的近似值为x*，则近似值与准确值之间的差成为误差，这个误差通常记为e*：

$$ e^* = x^* - x $$

有时也记为e(x*)。误差有时被称为绝对误差。

当误差是正值时，称为强近似。当误差时负值时，称为弱近似。

### 误差限

**定义1.2** 若$ |e^*| = | x^* - x | \leq \epsilon^* $，则$\epsilon^*$称为近似值x* 的误差限，近似值x*的误差限也记为$\epsilon(x^*)$。

### 有效数字

对任何数值经过四舍五入之后所得到的近似值，它的误差限时它末位的半个单位。

**定义1.3** 若近似值x* 的误差限为该值的某一位的半个单位，且从该位开始往左数到x* 的第一位非0数字共有n位，则成近似值x* 具有n位有效数字。

### 有效数字与误差限的关系

设x* 为准确值x的近似值，且将x* 表示为：

$$ x^* = \pm 0.\alpha_1\alpha_2...\alpha_m \times 10^p $$

其中p为整数；$\alpha_1, \alpha_2, ...,\alpha_m$为0 ~ 9之间的数字，且$\alpha_1\neq0$，若有：

$$ |x^* - x| \leq \frac{1}{2} \times 10^{p-n} $$

则近似值x* 具有n位有效数字。如果知道了近似值的误差限，就知道它有几位有效数字，反之亦然。

## 1.3 相对误差和相对误差限

### 相对误差

**定义1.4** 若记$ e{_r^*} = \frac{x^* - x}{x} $，则$e{_r^*}$称为x* 的相对误差。在实际计算中分母中的x用x* 代替：

$$ e{_r^*} = \frac{x^* - x}{x^*} $$

### 相对误差限

**定义1.5** 若记$ \epsilon{_r^*} = \frac{\epsilon^*}{|x^*|} $，则$\epsilon{_r^*}$称为近似值x* 的相对误差限。

### 相对误差限与有效数字的关系

**定理1.1** 若近似数$x^* = \pm 0.\alpha_1\alpha_2...\alpha_m \times 10^p$具有n位有效数字（$n \leq m$），则其相对误差限为

$$ \epsilon{_r^*} = \frac{\epsilon^*}{|x^*|} \leq \frac{1}{2\alpha_1} \times 10^{-(n-1)} $$

可以看出，相对误差限与p时没有关系的，只与有效数字的位数有关。**注意上式只能正推，即已知有效数字位数，推导其相对误差限。**

证明过程略，比较简单。

**定理1.2** 若近似数$x^* = \pm 0.\alpha_1\alpha_2...\alpha_m \times 10^p$，且相对误差限满足关系式

$$  \epsilon{_r^*} \leq \frac{1}{2(\alpha_1 + 1)} \times 10^{-(n-1)} $$

则x* 具有n位有效数字。

## 1.4 数值计算中的误差估计

计算一元函数f(x)时的误差估计：

f(x*)的绝对误差：

$$ e(f(x^*)) \approx f^{'}(x^*)e(x^*) $$

f(x*)的相对误差：

$$ e_r(f(x^*)) \approx \frac{f^{'}(x^*)}{f(x^*)}e(x^*) $$

f(x*)的误差限：

$$ \epsilon(f(x^*)) \approx |f^{'}(x^*)|\epsilon(x^*) $$

f(x*)的相对误差限：

$$ \epsilon_r(f(x^*)) \approx |\frac{f^{'}(x^*)}{f(x^*)}|\epsilon(x^*) $$

利用二元函数泰勒公式可以得到如下两个数的和、差、积与商的误差估计式：

$$ e(x^* \pm y^*) = e(x^*) \pm e(y^*) $$
$$ e(x^* \cdot y^*) \approx |y^*|e(x^*) + |x^*|e(y^*) $$
$$ e(\frac{x^*}{y^*}) \approx \frac{1}{y^*}e(x^*) - \frac{x^*}{(y^*)^2}e(y^*) $$
$$ \epsilon(x^* \pm y^*) \leq \epsilon(x^*) + \epsilon(y^*) $$
$$ \epsilon(x^* \cdot y^*) \leq |y^*|\epsilon(x^*) + |x^*|\epsilon(y^*) $$
$$ \epsilon(\frac{x^*}{y^*}) \leq \frac{|y^*|\epsilon(x^*) + |x^*|\epsilon(y^*)}{(y^*)^2} $$
$$ e_r(x^* + y^*) \approx \frac{x^*}{x^*+y^*}e_r(x^*) + \frac{x^*}{x^*+y^*}e_r(y^*) $$
$$ e_r(x^* - y^*) \approx \frac{x^*}{x^*-y^*}e_r(x^*) - \frac{x^*}{x^*-y^*}e_r(y^*) $$
$$ e_r(x^* \cdot y^*) \approx e_r(x^*) + e_r(y^*) $$
$$ e_r(\frac{x^*}{y^*}) \approx e_r(x^*) - e_r(y^*) $$
$$ \epsilon_r(x^* \pm y^*) \leq \frac{\epsilon_r(x^*) + \epsilon_r(y^*)}{|x^* \pm y^*|} $$
$$ \epsilon_r(x^* \cdot y^*) \leq \epsilon_r(x^*) + \epsilon_r(y^*) $$
$$ \epsilon_r(\frac{x^*}{y^*}) \leq \epsilon_r(x^*) + \epsilon_r(y^*) $$


## 1.5 数值计算中应注意的一些问题

1. 避免两个相近的数相减。

    会导致相对误差限较大。

2. 要防止小数被大数“吃掉”而使有效数字位丢失。

3. 要注意减少运算的次数。

4. 避免做除数绝对值远远小于被除数绝对值的除法。

    这样得到的数一定会较大，有可能会产生溢出错误。如果不溢出，也有可能会使舍入误差严重增大。

5. 要选择数值稳定的计算公式。
