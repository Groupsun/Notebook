# 卷积

# 定义

函数f，g是定义在n维实数空间上的可测函数，f与g的卷积记作$f \ast g$，它是其中一个函数翻转并平移后与另一个函数的乘积的积分，是一个对平移量的函数，也就是：

$$ (f \ast g)(t) \overset{def}{=} \int_{R^n} f(\tau)g(t - \tau)d\tau $$

如果函数不是定义在n维实数空间上，可以把函数定义域以外的值都规定为0，这样就变成一个定义在n维实数空间上的数。

可以将卷积理解为一个函数g中$\tau$从负无穷滑动到正无穷，f与g交会时，两函数乘积的积分值。也可以说是在计算一个滑动的加权总和，其中$g(t-\tau)$是加权函数。

![avatar](./images/Convolution_of_box_signal_with_itself2.gif)

# 离散卷积

对于定义在整数集上的函数f，g，卷积定义为：

$$ (f \ast g)[n] \overset{def}{=} \sum_{m=-\infty}^{\infty} f[m]g[n-m] $$

这里一样把函数定义域以外的值都当成0，所以可以扩展到所有整数上。

当g[n]的支撑集为有限长度M，上式会变成有限和：

$$ (f \ast g)[n] = \sum_{m=-M}^{M} f[m]g[n-m] $$

## 计算离散卷积的方法

有三种主要的方法：

1. 直接计算（Direct Method）
2. 快速傅里叶变换（FFT）
3. 分段卷积（sectioned convolution）

# 应用

## 有限脉冲响应滤波器

在FIR滤波器当中，利用了卷积的运算来计算滤波器的输出。

N-阶FIR滤波器的系数h与输入信号x的卷积可由离散卷积来表示（滤波器的信号来源是从连续信号中采集得来的离散信号）：

$$ y[i] = \sum_{j=0}^{N-1} h[j] \cdot x[i-j] $$

实际上，上式代表的是输入信号与N-阶系数的加权和。考虑低通FIR滤波器中的一种简单形式：滑动均值滤波器（Moving average filters），其所有系数都是相同的，且和为1。举一个3点滑动滤波器为例子，其系数h=[1/3, 1/3, 1/3]。其卷积核形状也与一个矩形类似，因此也被称为矩形滤波器。实际上，它就是将输入信号的几个相邻样本相加并求平均值，相邻样本的数量根据滤波器的阶数来决定。比如，下面一个输入信号的序列x[]：

```
x[0] x[1] x[2]
 2    7    1
```

经过3点滑动均值滤波器后得到的输出信号为：

```
x[]:      2     7     1  
h[]:     1/3   1/3   1/3
y[]:2/3   3    10/3  8/3  1/3
```
